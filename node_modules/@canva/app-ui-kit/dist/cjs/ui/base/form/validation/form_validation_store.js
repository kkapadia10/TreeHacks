"use strict";

const makeObservable = require('../../../../base/make_observable/make_observable').makeObservable;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useRegisterFormValidation = exports.FormValidationContext = exports.FormValidationStore = void 0;
const tslib_1 = require("tslib");
const mobx = require("mobx");
const React = require("react");
class FormValidationStore {
  static _makeObservable(instance) {
    makeObservable(instance, {
      fields: mobx.observable.shallow
    });
  }
  constructor() {
    FormValidationStore._makeObservable(this);
    this.fields = new Map();
  }
}
exports.FormValidationStore = FormValidationStore;
const registerField = mobx.action((store, fieldName, fieldValidationStore) => {
  store.fields.set(fieldName, fieldValidationStore);
});
const deregisterField = mobx.action((store, fieldName) => {
  store.fields.delete(fieldName);
});
exports.FormValidationContext = React.createContext(null);
function useRegisterFormValidation(
  {
    name,
    fieldValidation
  }
) {
  var _a;
  const store = (_a = React.useContext(exports.FormValidationContext)) === null || _a === void 0 ? void 0 : _a.store;
  React.useEffect(() => {
    if (store == null || name == null) {
      return;
    }
    registerField(store, name, fieldValidation);
    return () => {
      deregisterField(store, name);
    };
  }, [fieldValidation, name, store]);
}
exports.useRegisterFormValidation = useRegisterFormValidation;